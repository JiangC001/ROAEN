cuda memory allocated: 445967360
n_trainable_params: 110561582, n_nontrainable_params: 0
training arguments:
>>> model_name: ourmodel_bert
>>> dataset: laptop
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x0000014E584B83A0>
>>> learning_rate: 0.002
>>> l2reg: 0.0001
>>> num_epoch: 10
>>> batch_size: 16
>>> log_step: 5
>>> post_dim: 30
>>> pos_dim: 30
>>> polarities_dim: 4
>>> input_dropout: 0.7
>>> gcn_dropout: 0.1
>>> lower: True
>>> direct: False
>>> loop: True
>>> attention_heads: 5
>>> max_length: 85
>>> device: cuda:0
>>> seed: 1000
>>> weight_decay: 0.0
>>> vocab_dir: ./dataset_/Laptops_corenlp
>>> pad_id: 0
>>> parseadj: False
>>> parsehead: False
>>> cuda: 0
>>> losstype: None
>>> pretrained_bert_name: bert-base-uncased
>>> adam_epsilon: 1e-08
>>> bert_dim: 768
>>> bert_dropout: 0.3
>>> diff_lr: False
>>> bert_lr: 2e-05
>>> BGCNlayer_num: 2
>>> AGCNlayer_num: 2
>>> c_c_Attention_num: 3
>>> c_a_Attention_num: 3
>>> gate_Attention_num: 1
>>> c_c_heads: 5
>>> c_a_heads: 5
>>> gate_heads: 1
>>> attention_dim: 200
>>> bgcn_dim: 200
>>> rand: 0.01
>>> lambda_1: 0.3
>>> lambda_2: 2e-06
>>> init_weight: False
>>> save_laptop_acc: 0.82
>>> save_restaurant_acc: 0.874
>>> save_twitter_acc: 0.779
>>> save_restaurant15_acc: 0.856
>>> save_restaurant16_acc: 0.92
>>> restaurant_acc: 0.874
>>> laptop_acc: 0.82
>>> twitter_acc: 0.779
>>> restaurant15_acc: 0.856
>>> restaurant16_acc: 0.92
>>> model_class: <class 'models.ourmodel_z_d_f1.OurModelBertClassifier'>
>>> dataset_file: {'train': './dataset_2/Laptops_corenlp/train_write.json', 'test': './dataset_2/Laptops_corenlp/test_write.json'}
>>> inputs_cols: ['adj_f', 'adj_b', 'adj_f_aspect', 'adj_b_aspect', 'text_bert_indices', 'bert_segments_ids', 'attention_mask', 'text_len', 'post_1', 'asp_start', 'asp_end', 'src_mask', 'aspect_mask', 'polarity']
bert learning rate on
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.2285_test_acc_0.5214[39m
[33m  1.0   loss: 1.4138, acc: 0.5000, test_f1: 0.2285, acc: 0.5214[39m
[33m  2.0   loss: 1.4259, acc: 0.4375, test_f1: 0.2285, acc: 0.5214[39m
[33m  3.0   loss: 1.4089, acc: 0.4167, test_f1: 0.2285, acc: 0.5214[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.3521_test_acc_0.5688[39m
[33m  4.0   loss: 1.4056, acc: 0.3906, test_f1: 0.3521, acc: 0.5688[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.4711_test_acc_0.6468[39m
[33m  5.0   loss: 1.3903, acc: 0.4375, test_f1: 0.4711, acc: 0.6468[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.4742_test_acc_0.6437[39m
[33m  6.0   loss: 1.4186, acc: 0.4375, test_f1: 0.4742, acc: 0.6437[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.4765_test_acc_0.6498[39m
[33m  7.0   loss: 1.3684, acc: 0.4643, test_f1: 0.4765, acc: 0.6498[39m
[33m  8.0   loss: 1.3694, acc: 0.4688, test_f1: 0.4682, acc: 0.6437[39m
[33m  9.0   loss: 1.2067, acc: 0.5000, test_f1: 0.4759, acc: 0.6437[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.4829_test_acc_0.6544[39m
[33m  10.0   loss: 1.0757, acc: 0.5375, test_f1: 0.4829, acc: 0.6544[39m
[33m  11.0   loss: 1.0127, acc: 0.5682, test_f1: 0.4772, acc: 0.6437[39m
[33m  12.0   loss: 0.9986, acc: 0.5885, test_f1: 0.4773, acc: 0.6437[39m
[33m  13.0   loss: 0.9877, acc: 0.6010, test_f1: 0.4789, acc: 0.6498[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.4839_test_acc_0.6560[39m
[33m  14.0   loss: 1.0096, acc: 0.6116, test_f1: 0.4839, acc: 0.6560[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.4910_test_acc_0.6606[39m
[33m  15.0   loss: 1.1021, acc: 0.6167, test_f1: 0.4910, acc: 0.6606[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.4972_test_acc_0.6621[39m
[33m  16.0   loss: 1.3400, acc: 0.6172, test_f1: 0.4972, acc: 0.6621[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.5897_test_acc_0.6942[39m
[33m  17.0   loss: 1.0466, acc: 0.6213, test_f1: 0.5897, acc: 0.6942[39m
[33m  18.0   loss: 0.9498, acc: 0.6319, test_f1: 0.5648, acc: 0.6621[39m
[33m  19.0   loss: 0.8802, acc: 0.6414, test_f1: 0.5296, acc: 0.6713[39m
[33m  20.0   loss: 0.7816, acc: 0.6531, test_f1: 0.5209, acc: 0.6636[39m
[33m  21.0   loss: 1.0480, acc: 0.6577, test_f1: 0.5396, acc: 0.6804[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.5897_test_acc_0.6957[39m
[33m  22.0   loss: 0.9151, acc: 0.6619, test_f1: 0.5897, acc: 0.6957[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.6466_test_acc_0.7232[39m
[33m  23.0   loss: 1.1900, acc: 0.6576, test_f1: 0.6466, acc: 0.7232[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.6716_test_acc_0.7339[39m
[33m  24.0   loss: 1.0720, acc: 0.6641, test_f1: 0.6716, acc: 0.7339[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.6808_test_acc_0.7416[39m
[33m  25.0   loss: 0.9948, acc: 0.6700, test_f1: 0.6808, acc: 0.7416[39m
[33m  26.0   loss: 0.9447, acc: 0.6707, test_f1: 0.6705, acc: 0.7401[39m
[33m  27.0   loss: 0.8954, acc: 0.6736, test_f1: 0.6327, acc: 0.7202[39m
[33m  28.0   loss: 0.9337, acc: 0.6741, test_f1: 0.6652, acc: 0.7385[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.7041_test_acc_0.7523[39m
[33m  29.0   loss: 0.7311, acc: 0.6789, test_f1: 0.7041, acc: 0.7523[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
[33m  30.0   loss: 1.0285, acc: 0.7500, test_f1: 0.6495, acc: 0.7049[39m
[33m  31.0   loss: 1.1364, acc: 0.7500, test_f1: 0.6433, acc: 0.7095[39m
[33m  32.0   loss: 0.9223, acc: 0.7708, test_f1: 0.6310, acc: 0.7217[39m
[33m  33.0   loss: 0.8339, acc: 0.7812, test_f1: 0.6347, acc: 0.7248[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.7050_test_acc_0.7615[39m
[33m  34.0   loss: 0.7125, acc: 0.8000, test_f1: 0.7050, acc: 0.7615[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.7199_test_acc_0.7569[39m
[33m  35.0   loss: 0.9830, acc: 0.7917, test_f1: 0.7199, acc: 0.7569[39m
[33m  36.0   loss: 0.6465, acc: 0.8214, test_f1: 0.7151, acc: 0.7630[39m
[33m  37.0   loss: 0.9181, acc: 0.8281, test_f1: 0.7000, acc: 0.7584[39m
[33m  38.0   loss: 0.8099, acc: 0.8333, test_f1: 0.7051, acc: 0.7569[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.7220_test_acc_0.7584[39m
[33m  39.0   loss: 0.9774, acc: 0.8313, test_f1: 0.7220, acc: 0.7584[39m
[33m  40.0   loss: 0.9170, acc: 0.8182, test_f1: 0.7129, acc: 0.7554[39m
[33m  41.0   loss: 0.5845, acc: 0.8333, test_f1: 0.7159, acc: 0.7584[39m
[33m  42.0   loss: 0.7469, acc: 0.8317, test_f1: 0.7219, acc: 0.7645[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.7242_test_acc_0.7661[39m
[33m  43.0   loss: 1.3543, acc: 0.8125, test_f1: 0.7242, acc: 0.7661[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.7476_test_acc_0.7829[39m
[33m  44.0   loss: 0.9135, acc: 0.8083, test_f1: 0.7476, acc: 0.7829[39m
[33m  45.0   loss: 0.8202, acc: 0.8047, test_f1: 0.7421, acc: 0.7706[39m
[33m  46.0   loss: 0.9988, acc: 0.7978, test_f1: 0.7150, acc: 0.7446[39m
[33m  47.0   loss: 0.9929, acc: 0.7917, test_f1: 0.7077, acc: 0.7630[39m
[33m  48.0   loss: 1.1189, acc: 0.7829, test_f1: 0.7154, acc: 0.7676[39m
[33m  49.0   loss: 0.7002, acc: 0.7875, test_f1: 0.7287, acc: 0.7645[39m
[33m  50.0   loss: 0.7506, acc: 0.7887, test_f1: 0.7174, acc: 0.7584[39m
[33m  51.0   loss: 0.7493, acc: 0.7955, test_f1: 0.6952, acc: 0.7492[39m
[33m  52.0   loss: 0.5530, acc: 0.7989, test_f1: 0.6720, acc: 0.7416[39m
[33m  53.0   loss: 1.1197, acc: 0.7943, test_f1: 0.6565, acc: 0.7385[39m
[33m  54.0   loss: 0.6443, acc: 0.8000, test_f1: 0.7252, acc: 0.7752[39m
[33m  55.0   loss: 0.8620, acc: 0.7981, test_f1: 0.7291, acc: 0.7676[39m
[33m  56.0   loss: 1.0088, acc: 0.7963, test_f1: 0.7314, acc: 0.7737[39m
[33m  57.0   loss: 0.6905, acc: 0.8013, test_f1: 0.7278, acc: 0.7722[39m
[33m  58.0   loss: 0.7995, acc: 0.8039, test_f1: 0.7184, acc: 0.7691[39m
[33m  59.0   loss: 0.9799, acc: 0.8042, test_f1: 0.7168, acc: 0.7661[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
[33m  60.0   loss: 0.7028, acc: 0.8125, test_f1: 0.7197, acc: 0.7752[39m
[33m  61.0   loss: 0.6900, acc: 0.8438, test_f1: 0.7378, acc: 0.7783[39m
[33m  62.0   loss: 0.6667, acc: 0.8125, test_f1: 0.7451, acc: 0.7813[39m
[33m  63.0   loss: 0.5224, acc: 0.8438, test_f1: 0.7371, acc: 0.7676[39m
[33m  64.0   loss: 0.5815, acc: 0.8625, test_f1: 0.7351, acc: 0.7722[39m
[33m  65.0   loss: 0.8868, acc: 0.8542, test_f1: 0.7211, acc: 0.7661[39m
[33m  66.0   loss: 0.4508, acc: 0.8750, test_f1: 0.7273, acc: 0.7737[39m
[33m  67.0   loss: 0.7474, acc: 0.8672, test_f1: 0.7370, acc: 0.7798[39m
[33m  68.0   loss: 0.8062, acc: 0.8611, test_f1: 0.7392, acc: 0.7722[39m
[33m  69.0   loss: 0.7707, acc: 0.8625, test_f1: 0.7355, acc: 0.7554[39m
[33m  70.0   loss: 0.6282, acc: 0.8693, test_f1: 0.7355, acc: 0.7615[39m
[33m  71.0   loss: 0.6633, acc: 0.8698, test_f1: 0.7131, acc: 0.7569[39m
[33m  72.0   loss: 0.7272, acc: 0.8702, test_f1: 0.6920, acc: 0.7523[39m
[33m  73.0   loss: 0.7500, acc: 0.8661, test_f1: 0.7295, acc: 0.7768[39m
[33m  74.0   loss: 0.7768, acc: 0.8667, test_f1: 0.6939, acc: 0.7446[39m
[33m  75.0   loss: 1.0136, acc: 0.8555, test_f1: 0.6780, acc: 0.7385[39m
[33m  76.0   loss: 1.0239, acc: 0.8529, test_f1: 0.7380, acc: 0.7783[39m
[33m  77.0   loss: 0.7798, acc: 0.8507, test_f1: 0.7184, acc: 0.7691[39m
[33m  78.0   loss: 0.9175, acc: 0.8454, test_f1: 0.7153, acc: 0.7630[39m
[33m  79.0   loss: 0.6016, acc: 0.8500, test_f1: 0.7220, acc: 0.7599[39m
[33m  80.0   loss: 0.5776, acc: 0.8512, test_f1: 0.7363, acc: 0.7706[39m
[33m  81.0   loss: 0.8744, acc: 0.8494, test_f1: 0.7399, acc: 0.7752[39m
[33m  82.0   loss: 0.6158, acc: 0.8505, test_f1: 0.7424, acc: 0.7798[39m
[33m  83.0   loss: 0.5685, acc: 0.8542, test_f1: 0.7281, acc: 0.7691[39m
[33m  84.0   loss: 0.5604, acc: 0.8575, test_f1: 0.7434, acc: 0.7798[39m
[33m  85.0   loss: 0.8044, acc: 0.8534, test_f1: 0.7440, acc: 0.7813[39m
[33m  86.0   loss: 0.8177, acc: 0.8519, test_f1: 0.7294, acc: 0.7737[39m
[33m  87.0   loss: 0.4947, acc: 0.8571, test_f1: 0.7358, acc: 0.7768[39m
[33m  88.0   loss: 0.4197, acc: 0.8621, test_f1: 0.7410, acc: 0.7783[39m
[33m  89.0   loss: 0.6652, acc: 0.8646, test_f1: 0.7404, acc: 0.7722[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
[33m  90.0   loss: 0.7301, acc: 0.9375, test_f1: 0.7415, acc: 0.7706[39m
[33m  91.0   loss: 0.9547, acc: 0.8750, test_f1: 0.7337, acc: 0.7752[39m
[33m  92.0   loss: 0.5533, acc: 0.8958, test_f1: 0.7358, acc: 0.7768[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.7506_test_acc_0.7859[39m
[33m  93.0   loss: 0.4869, acc: 0.9062, test_f1: 0.7506, acc: 0.7859[39m
[33m  94.0   loss: 0.5081, acc: 0.9250, test_f1: 0.7453, acc: 0.7813[39m
[33m  95.0   loss: 0.9003, acc: 0.9167, test_f1: 0.7468, acc: 0.7829[39m
[33m  96.0   loss: 0.7600, acc: 0.9107, test_f1: 0.7375, acc: 0.7737[39m
[33m  97.0   loss: 0.6618, acc: 0.9219, test_f1: 0.7279, acc: 0.7615[39m
[33m  98.0   loss: 1.1100, acc: 0.9097, test_f1: 0.7270, acc: 0.7691[39m
[33m  99.0   loss: 0.9538, acc: 0.9000, test_f1: 0.7318, acc: 0.7737[39m
[33m  100.0   loss: 0.7298, acc: 0.8977, test_f1: 0.7117, acc: 0.7599[39m
[33m  101.0   loss: 0.7260, acc: 0.8906, test_f1: 0.7429, acc: 0.7768[39m
[33m  102.0   loss: 0.5638, acc: 0.8942, test_f1: 0.7363, acc: 0.7615[39m
[33m  103.0   loss: 0.9600, acc: 0.8884, test_f1: 0.7454, acc: 0.7875[39m
[33m  104.0   loss: 1.0771, acc: 0.8875, test_f1: 0.7123, acc: 0.7661[39m
[33m  105.0   loss: 0.8757, acc: 0.8867, test_f1: 0.7417, acc: 0.7783[39m
[33m  106.0   loss: 0.7298, acc: 0.8787, test_f1: 0.7390, acc: 0.7691[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.7538_test_acc_0.7829[39m
[33m  107.0   loss: 0.5585, acc: 0.8819, test_f1: 0.7538, acc: 0.7829[39m
[33m  108.0   loss: 0.4584, acc: 0.8882, test_f1: 0.7406, acc: 0.7783[39m
[33m  109.0   loss: 0.5154, acc: 0.8906, test_f1: 0.7335, acc: 0.7722[39m
[33m  110.0   loss: 0.7121, acc: 0.8899, test_f1: 0.7486, acc: 0.7844[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.7599_test_acc_0.7905[39m
[33m  111.0   loss: 0.4934, acc: 0.8949, test_f1: 0.7599, acc: 0.7905[39m
[33m  112.0   loss: 0.3452, acc: 0.8995, test_f1: 0.7406, acc: 0.7798[39m
[33m  113.0   loss: 0.4800, acc: 0.9036, test_f1: 0.7296, acc: 0.7722[39m
[33m  114.0   loss: 0.6385, acc: 0.9075, test_f1: 0.7198, acc: 0.7599[39m
[33m  115.0   loss: 0.7357, acc: 0.9087, test_f1: 0.7206, acc: 0.7523[39m
[33m  116.0   loss: 0.6556, acc: 0.9120, test_f1: 0.7385, acc: 0.7706[39m
[33m  117.0   loss: 0.8926, acc: 0.9129, test_f1: 0.7526, acc: 0.7829[39m
[33m  118.0   loss: 0.9778, acc: 0.9116, test_f1: 0.7460, acc: 0.7798[39m
[33m  119.0   loss: 0.7930, acc: 0.9125, test_f1: 0.7548, acc: 0.7875[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
[33m  120.0   loss: 0.7702, acc: 1.0000, test_f1: 0.7389, acc: 0.7661[39m
[33m  121.0   loss: 0.7989, acc: 0.9375, test_f1: 0.7105, acc: 0.7523[39m
[33m  122.0   loss: 0.6242, acc: 0.9583, test_f1: 0.6918, acc: 0.7431[39m
[33m  123.0   loss: 0.9512, acc: 0.9375, test_f1: 0.7173, acc: 0.7554[39m
[33m  124.0   loss: 1.4209, acc: 0.9125, test_f1: 0.7479, acc: 0.7798[39m
[33m  125.0   loss: 0.7757, acc: 0.9167, test_f1: 0.7321, acc: 0.7691[39m
[33m  126.0   loss: 0.5738, acc: 0.9286, test_f1: 0.7424, acc: 0.7783[39m
[33m  127.0   loss: 0.8170, acc: 0.9375, test_f1: 0.7390, acc: 0.7752[39m
[33m  128.0   loss: 1.1024, acc: 0.9375, test_f1: 0.7258, acc: 0.7676[39m
[33m  129.0   loss: 0.9828, acc: 0.9313, test_f1: 0.7344, acc: 0.7691[39m
[33m  130.0   loss: 0.7042, acc: 0.9375, test_f1: 0.7362, acc: 0.7706[39m
[33m  131.0   loss: 0.7137, acc: 0.9375, test_f1: 0.7264, acc: 0.7645[39m
[33m  132.0   loss: 0.8829, acc: 0.9327, test_f1: 0.7185, acc: 0.7599[39m
[33m  133.0   loss: 0.8518, acc: 0.9330, test_f1: 0.7383, acc: 0.7752[39m
[33m  134.0   loss: 0.8140, acc: 0.9333, test_f1: 0.7465, acc: 0.7813[39m
[33m  135.0   loss: 0.5656, acc: 0.9375, test_f1: 0.7506, acc: 0.7859[39m
[33m  136.0   loss: 0.4174, acc: 0.9412, test_f1: 0.7414, acc: 0.7798[39m
[33m  137.0   loss: 0.5460, acc: 0.9444, test_f1: 0.7405, acc: 0.7768[39m
[33m  138.0   loss: 0.7248, acc: 0.9408, test_f1: 0.7442, acc: 0.7798[39m
[33m  139.0   loss: 0.8604, acc: 0.9375, test_f1: 0.7002, acc: 0.7492[39m
[33m  140.0   loss: 0.8380, acc: 0.9375, test_f1: 0.7131, acc: 0.7569[39m
[33m  141.0   loss: 1.0167, acc: 0.9347, test_f1: 0.7454, acc: 0.7768[39m
[33m  142.0   loss: 0.8393, acc: 0.9375, test_f1: 0.7495, acc: 0.7798[39m
[33m  143.0   loss: 0.8123, acc: 0.9375, test_f1: 0.7367, acc: 0.7752[39m
[33m  144.0   loss: 0.5146, acc: 0.9400, test_f1: 0.7242, acc: 0.7676[39m
[33m  145.0   loss: 1.3839, acc: 0.9351, test_f1: 0.7238, acc: 0.7661[39m
[33m  146.0   loss: 1.2524, acc: 0.9329, test_f1: 0.7301, acc: 0.7676[39m
[33m  147.0   loss: 0.7811, acc: 0.9330, test_f1: 0.7290, acc: 0.7706[39m
[33m  148.0   loss: 0.8293, acc: 0.9332, test_f1: 0.7225, acc: 0.7691[39m
[33m  149.0   loss: 0.6462, acc: 0.9339, test_f1: 0.7226, acc: 0.7691[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
[33m  150.0   loss: 0.6447, acc: 1.0000, test_f1: 0.7354, acc: 0.7768[39m
[33m  151.0   loss: 0.6015, acc: 1.0000, test_f1: 0.7495, acc: 0.7798[39m
[33m  152.0   loss: 1.0485, acc: 0.9792, test_f1: 0.7522, acc: 0.7844[39m
[33m  153.0   loss: 1.0281, acc: 0.9531, test_f1: 0.7196, acc: 0.7676[39m
[33m  154.0   loss: 0.6956, acc: 0.9625, test_f1: 0.7139, acc: 0.7661[39m
[33m  155.0   loss: 0.7487, acc: 0.9688, test_f1: 0.7365, acc: 0.7783[39m
[33m  156.0   loss: 0.7145, acc: 0.9732, test_f1: 0.7367, acc: 0.7768[39m
[33m  157.0   loss: 0.7679, acc: 0.9766, test_f1: 0.7372, acc: 0.7768[39m
[33m  158.0   loss: 0.5955, acc: 0.9792, test_f1: 0.7409, acc: 0.7798[39m
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.7622_test_acc_0.7951[39m
[33m  159.0   loss: 1.1974, acc: 0.9625, test_f1: 0.7622, acc: 0.7951[39m
[33m  160.0   loss: 0.8243, acc: 0.9602, test_f1: 0.7422, acc: 0.7813[39m
[33m  161.0   loss: 1.0396, acc: 0.9583, test_f1: 0.7287, acc: 0.7691[39m
[33m  162.0   loss: 0.7128, acc: 0.9615, test_f1: 0.7366, acc: 0.7768[39m
[33m  163.0   loss: 0.9219, acc: 0.9643, test_f1: 0.7350, acc: 0.7752[39m
[33m  164.0   loss: 0.8009, acc: 0.9667, test_f1: 0.7418, acc: 0.7768[39m
[33m  165.0   loss: 0.9377, acc: 0.9688, test_f1: 0.7287, acc: 0.7661[39m
[33m  166.0   loss: 1.2775, acc: 0.9669, test_f1: 0.7355, acc: 0.7691[39m
[33m  167.0   loss: 1.1877, acc: 0.9688, test_f1: 0.7355, acc: 0.7722[39m
[33m  168.0   loss: 0.9144, acc: 0.9704, test_f1: 0.7371, acc: 0.7798[39m
[33m  169.0   loss: 1.3788, acc: 0.9656, test_f1: 0.7390, acc: 0.7752[39m
[33m  170.0   loss: 0.8608, acc: 0.9673, test_f1: 0.7504, acc: 0.7813[39m
[33m  171.0   loss: 0.8859, acc: 0.9659, test_f1: 0.7390, acc: 0.7691[39m
[33m  172.0   loss: 0.9864, acc: 0.9620, test_f1: 0.7321, acc: 0.7661[39m
[33m  173.0   loss: 0.9041, acc: 0.9609, test_f1: 0.7410, acc: 0.7798[39m
[33m  174.0   loss: 0.6818, acc: 0.9625, test_f1: 0.7039, acc: 0.7569[39m
[33m  175.0   loss: 1.4017, acc: 0.9591, test_f1: 0.7126, acc: 0.7645[39m
[33m  176.0   loss: 0.8475, acc: 0.9606, test_f1: 0.7343, acc: 0.7783[39m
[33m  177.0   loss: 0.9184, acc: 0.9598, test_f1: 0.7397, acc: 0.7798[39m
[33m  178.0   loss: 0.9442, acc: 0.9591, test_f1: 0.7441, acc: 0.7813[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
[33m  179.0   loss: 0.7668, acc: 1.0000, test_f1: 0.7484, acc: 0.7798[39m
[33m  180.0   loss: 1.2308, acc: 1.0000, test_f1: 0.7370, acc: 0.7706[39m
[33m  181.0   loss: 1.1330, acc: 1.0000, test_f1: 0.7364, acc: 0.7783[39m
[33m  182.0   loss: 1.2821, acc: 0.9844, test_f1: 0.7263, acc: 0.7752[39m
[33m  183.0   loss: 1.1885, acc: 0.9750, test_f1: 0.7341, acc: 0.7768[39m
[33m  184.0   loss: 1.2503, acc: 0.9792, test_f1: 0.7235, acc: 0.7676[39m
[33m  185.0   loss: 1.2703, acc: 0.9821, test_f1: 0.7335, acc: 0.7691[39m
[33m  186.0   loss: 1.0690, acc: 0.9844, test_f1: 0.7540, acc: 0.7844[39m
[33m  187.0   loss: 1.1515, acc: 0.9861, test_f1: 0.7542, acc: 0.7813[39m
[33m  188.0   loss: 1.4854, acc: 0.9750, test_f1: 0.7576, acc: 0.7844[39m
[33m  189.0   loss: 1.3616, acc: 0.9716, test_f1: 0.7438, acc: 0.7783[39m
[33m  190.0   loss: 1.1429, acc: 0.9635, test_f1: 0.7320, acc: 0.7783[39m
[33m  191.0   loss: 1.1254, acc: 0.9663, test_f1: 0.7283, acc: 0.7752[39m
[33m  192.0   loss: 1.3023, acc: 0.9688, test_f1: 0.7194, acc: 0.7706[39m
[33m  193.0   loss: 1.0780, acc: 0.9667, test_f1: 0.7419, acc: 0.7829[39m
[33m  194.0   loss: 1.5117, acc: 0.9609, test_f1: 0.7527, acc: 0.7859[39m
[33m  195.0   loss: 1.2012, acc: 0.9632, test_f1: 0.7241, acc: 0.7645[39m
[33m  196.0   loss: 0.8904, acc: 0.9583, test_f1: 0.7160, acc: 0.7599[39m
[33m  197.0   loss: 0.9103, acc: 0.9605, test_f1: 0.7093, acc: 0.7676[39m
[33m  198.0   loss: 0.6723, acc: 0.9625, test_f1: 0.6918, acc: 0.7569[39m
[33m  199.0   loss: 0.8489, acc: 0.9643, test_f1: 0.7294, acc: 0.7722[39m
[33m  200.0   loss: 0.8260, acc: 0.9631, test_f1: 0.7320, acc: 0.7722[39m
[33m  201.0   loss: 1.2219, acc: 0.9620, test_f1: 0.7381, acc: 0.7768[39m
[33m  202.0   loss: 1.6018, acc: 0.9583, test_f1: 0.7445, acc: 0.7813[39m
[33m  203.0   loss: 1.1985, acc: 0.9600, test_f1: 0.7568, acc: 0.7920[39m
[33m  204.0   loss: 1.0829, acc: 0.9615, test_f1: 0.7522, acc: 0.7920[39m
[33m  205.0   loss: 0.9288, acc: 0.9630, test_f1: 0.7428, acc: 0.7859[39m
[33m  206.0   loss: 1.1672, acc: 0.9643, test_f1: 0.7388, acc: 0.7829[39m
[33m  207.0   loss: 1.2283, acc: 0.9634, test_f1: 0.7276, acc: 0.7768[39m
[33m  208.0   loss: 0.8578, acc: 0.9646, test_f1: 0.7270, acc: 0.7768[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
[36m>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.7790_test_acc_0.8058[39m
[33m  209.0   loss: 1.0847, acc: 1.0000, test_f1: 0.7790, acc: 0.8058[39m
[33m  210.0   loss: 1.3088, acc: 1.0000, test_f1: 0.7767, acc: 0.8058[39m
[33m  211.0   loss: 0.9813, acc: 1.0000, test_f1: 0.7544, acc: 0.7890[39m
[33m  212.0   loss: 1.3363, acc: 0.9844, test_f1: 0.7192, acc: 0.7737[39m
[33m  213.0   loss: 1.2846, acc: 0.9750, test_f1: 0.6857, acc: 0.7538[39m
[33m  214.0   loss: 1.3132, acc: 0.9583, test_f1: 0.6976, acc: 0.7584[39m
[33m  215.0   loss: 1.2280, acc: 0.9643, test_f1: 0.7581, acc: 0.7905[39m
[33m  216.0   loss: 1.5463, acc: 0.9688, test_f1: 0.7536, acc: 0.7844[39m
[33m  217.0   loss: 1.7416, acc: 0.9653, test_f1: 0.7482, acc: 0.7813[39m
[33m  218.0   loss: 1.3264, acc: 0.9625, test_f1: 0.6771, acc: 0.7477[39m
[33m  219.0   loss: 1.1360, acc: 0.9602, test_f1: 0.6523, acc: 0.7370[39m
[33m  220.0   loss: 1.1549, acc: 0.9635, test_f1: 0.7546, acc: 0.7859[39m
[33m  221.0   loss: 1.9045, acc: 0.9615, test_f1: 0.7444, acc: 0.7737[39m
[33m  222.0   loss: 1.6050, acc: 0.9643, test_f1: 0.7466, acc: 0.7783[39m
[33m  223.0   loss: 1.3757, acc: 0.9625, test_f1: 0.7471, acc: 0.7859[39m
[33m  224.0   loss: 1.4117, acc: 0.9648, test_f1: 0.7402, acc: 0.7813[39m
[33m  225.0   loss: 1.1019, acc: 0.9669, test_f1: 0.7464, acc: 0.7859[39m
[33m  226.0   loss: 1.3708, acc: 0.9653, test_f1: 0.7432, acc: 0.7783[39m
[33m  227.0   loss: 1.3546, acc: 0.9671, test_f1: 0.7368, acc: 0.7661[39m
[33m  228.0   loss: 1.5005, acc: 0.9688, test_f1: 0.7302, acc: 0.7599[39m
[33m  229.0   loss: 1.5877, acc: 0.9673, test_f1: 0.7239, acc: 0.7569[39m
[33m  230.0   loss: 1.9705, acc: 0.9659, test_f1: 0.7332, acc: 0.7645[39m
[33m  231.0   loss: 1.7937, acc: 0.9674, test_f1: 0.7430, acc: 0.7722[39m
[33m  232.0   loss: 1.2747, acc: 0.9688, test_f1: 0.7509, acc: 0.7829[39m
[33m  233.0   loss: 1.3936, acc: 0.9700, test_f1: 0.7541, acc: 0.7875[39m
[33m  234.0   loss: 1.3723, acc: 0.9712, test_f1: 0.7490, acc: 0.7829[39m
[33m  235.0   loss: 1.4944, acc: 0.9676, test_f1: 0.7501, acc: 0.7829[39m
[33m  236.0   loss: 1.4781, acc: 0.9665, test_f1: 0.7470, acc: 0.7768[39m
[33m  237.0   loss: 2.3243, acc: 0.9634, test_f1: 0.7426, acc: 0.7691[39m
[33m  238.0   loss: 1.7803, acc: 0.9625, test_f1: 0.7475, acc: 0.7798[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
[33m  239.0   loss: 1.8154, acc: 1.0000, test_f1: 0.7415, acc: 0.7798[39m
[33m  240.0   loss: 1.6706, acc: 0.9375, test_f1: 0.7278, acc: 0.7722[39m
[33m  241.0   loss: 1.5968, acc: 0.9375, test_f1: 0.7307, acc: 0.7722[39m
[33m  242.0   loss: 1.5428, acc: 0.9531, test_f1: 0.7393, acc: 0.7737[39m
[33m  243.0   loss: 1.8683, acc: 0.9500, test_f1: 0.7390, acc: 0.7722[39m
[33m  244.0   loss: 1.8639, acc: 0.9583, test_f1: 0.7319, acc: 0.7676[39m
[33m  245.0   loss: 1.6481, acc: 0.9643, test_f1: 0.7281, acc: 0.7706[39m
[33m  246.0   loss: 1.3505, acc: 0.9688, test_f1: 0.7214, acc: 0.7691[39m
[33m  247.0   loss: 1.2751, acc: 0.9653, test_f1: 0.7154, acc: 0.7645[39m
[33m  248.0   loss: 1.0784, acc: 0.9625, test_f1: 0.7195, acc: 0.7661[39m
[33m  249.0   loss: 1.5541, acc: 0.9659, test_f1: 0.7185, acc: 0.7630[39m
[33m  250.0   loss: 1.4198, acc: 0.9688, test_f1: 0.7134, acc: 0.7584[39m
[33m  251.0   loss: 1.7179, acc: 0.9712, test_f1: 0.7157, acc: 0.7599[39m
[33m  252.0   loss: 1.6607, acc: 0.9688, test_f1: 0.7259, acc: 0.7630[39m
[33m  253.0   loss: 1.6154, acc: 0.9667, test_f1: 0.7390, acc: 0.7676[39m
[33m  254.0   loss: 1.8669, acc: 0.9688, test_f1: 0.7300, acc: 0.7554[39m
[33m  255.0   loss: 2.2955, acc: 0.9706, test_f1: 0.7459, acc: 0.7676[39m
[33m  256.0   loss: 1.9337, acc: 0.9722, test_f1: 0.7487, acc: 0.7783[39m
[33m  257.0   loss: 1.7565, acc: 0.9737, test_f1: 0.7413, acc: 0.7783[39m
[33m  258.0   loss: 1.9069, acc: 0.9719, test_f1: 0.7444, acc: 0.7813[39m
[33m  259.0   loss: 2.3478, acc: 0.9702, test_f1: 0.7321, acc: 0.7722[39m
[33m  260.0   loss: 1.5116, acc: 0.9716, test_f1: 0.7231, acc: 0.7661[39m
[33m  261.0   loss: 1.0235, acc: 0.9728, test_f1: 0.7472, acc: 0.7783[39m
[33m  262.0   loss: 2.0838, acc: 0.9688, test_f1: 0.7427, acc: 0.7706[39m
[33m  263.0   loss: 1.5084, acc: 0.9700, test_f1: 0.7424, acc: 0.7783[39m
[33m  264.0   loss: 1.6598, acc: 0.9712, test_f1: 0.6956, acc: 0.7492[39m
[33m  265.0   loss: 1.6722, acc: 0.9722, test_f1: 0.6791, acc: 0.7370[39m
[33m  266.0   loss: 1.2703, acc: 0.9710, test_f1: 0.7123, acc: 0.7584[39m
[33m  267.0   loss: 1.5676, acc: 0.9720, test_f1: 0.7397, acc: 0.7768[39m
[33m  268.0   loss: 2.0319, acc: 0.9729, test_f1: 0.7460, acc: 0.7813[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
[33m  269.0   loss: 1.7319, acc: 1.0000, test_f1: 0.7534, acc: 0.7859[39m
[33m  270.0   loss: 2.0419, acc: 1.0000, test_f1: 0.7566, acc: 0.7890[39m
[33m  271.0   loss: 1.7141, acc: 1.0000, test_f1: 0.7597, acc: 0.7920[39m
[33m  272.0   loss: 2.1810, acc: 0.9844, test_f1: 0.7566, acc: 0.7829[39m
[33m  273.0   loss: 1.9825, acc: 0.9875, test_f1: 0.7479, acc: 0.7737[39m
[33m  274.0   loss: 2.2605, acc: 0.9896, test_f1: 0.7435, acc: 0.7768[39m
[33m  275.0   loss: 2.0868, acc: 0.9911, test_f1: 0.7181, acc: 0.7615[39m
[33m  276.0   loss: 1.8598, acc: 0.9922, test_f1: 0.7244, acc: 0.7676[39m
[33m  277.0   loss: 1.8282, acc: 0.9931, test_f1: 0.7321, acc: 0.7737[39m
[33m  278.0   loss: 2.2056, acc: 0.9938, test_f1: 0.7358, acc: 0.7752[39m
[33m  279.0   loss: 2.1518, acc: 0.9943, test_f1: 0.7534, acc: 0.7844[39m
[33m  280.0   loss: 2.2094, acc: 0.9948, test_f1: 0.7501, acc: 0.7783[39m
[33m  281.0   loss: 1.9808, acc: 0.9952, test_f1: 0.7526, acc: 0.7813[39m
[33m  282.0   loss: 2.1186, acc: 0.9955, test_f1: 0.7488, acc: 0.7829[39m
[33m  283.0   loss: 1.6339, acc: 0.9917, test_f1: 0.7360, acc: 0.7737[39m
[33m  284.0   loss: 1.8194, acc: 0.9883, test_f1: 0.7308, acc: 0.7737[39m
[33m  285.0   loss: 1.8513, acc: 0.9853, test_f1: 0.7341, acc: 0.7722[39m
[33m  286.0   loss: 1.9961, acc: 0.9861, test_f1: 0.7451, acc: 0.7783[39m
[33m  287.0   loss: 2.1642, acc: 0.9868, test_f1: 0.7371, acc: 0.7676[39m
[33m  288.0   loss: 2.0867, acc: 0.9844, test_f1: 0.7376, acc: 0.7722[39m
[33m  289.0   loss: 1.5111, acc: 0.9851, test_f1: 0.7209, acc: 0.7691[39m
[33m  290.0   loss: 1.8151, acc: 0.9830, test_f1: 0.7192, acc: 0.7691[39m
[33m  291.0   loss: 1.4376, acc: 0.9837, test_f1: 0.7280, acc: 0.7752[39m
[33m  292.0   loss: 1.8248, acc: 0.9844, test_f1: 0.7348, acc: 0.7798[39m
[33m  293.0   loss: 1.9714, acc: 0.9850, test_f1: 0.7498, acc: 0.7844[39m
[33m  294.0   loss: 2.4102, acc: 0.9832, test_f1: 0.7252, acc: 0.7706[39m
[33m  295.0   loss: 1.6348, acc: 0.9838, test_f1: 0.7260, acc: 0.7737[39m
[33m  296.0   loss: 2.3754, acc: 0.9844, test_f1: 0.7217, acc: 0.7706[39m
[33m  297.0   loss: 2.0057, acc: 0.9828, test_f1: 0.7070, acc: 0.7615[39m
[33m  298.0   loss: 2.1804, acc: 0.9808, test_f1: 0.7184, acc: 0.7676[39m
max_test_acc: 0.7789960486874202, max_f1: 0.8058103975535168
>> saved: ./state_dict/ourmodel_bert_laptop_test_f1_0.7790_test_acc_0.8058
############################################################
NumExpr defaulting to 8 threads.
stop run time:Thu Apr  4 17:05:13 2024
run time (hour:minute:second): 0:58:00.516863
