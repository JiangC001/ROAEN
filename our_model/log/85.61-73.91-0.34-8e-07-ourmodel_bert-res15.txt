cuda memory allocated: 445967360
n_trainable_params: 110561582, n_nontrainable_params: 0
training arguments:
>>> model_name: ourmodel_bert
>>> dataset: restaurant15
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x000001BDA42BE430>
>>> learning_rate: 0.002
>>> l2reg: 0.0001
>>> num_epoch: 20
>>> batch_size: 16
>>> log_step: 5
>>> post_dim: 30
>>> pos_dim: 30
>>> polarities_dim: 3
>>> input_dropout: 0.7
>>> gcn_dropout: 0.1
>>> lower: True
>>> direct: False
>>> loop: True
>>> attention_heads: 5
>>> max_length: 85
>>> device: cuda:0
>>> seed: 1000
>>> weight_decay: 0.0
>>> vocab_dir: ./dataset_/Laptops_corenlp
>>> pad_id: 0
>>> parseadj: False
>>> parsehead: False
>>> cuda: 0
>>> losstype: None
>>> pretrained_bert_name: bert-base-uncased
>>> adam_epsilon: 1e-08
>>> bert_dim: 768
>>> bert_dropout: 0.3
>>> diff_lr: False
>>> bert_lr: 2e-05
>>> BGCNlayer_num: 2
>>> AGCNlayer_num: 2
>>> c_c_Attention_num: 3
>>> c_a_Attention_num: 3
>>> gate_Attention_num: 1
>>> c_c_heads: 5
>>> c_a_heads: 5
>>> gate_heads: 1
>>> attention_dim: 200
>>> bgcn_dim: 200
>>> rand: 0.01
>>> lambda_1: 0.34
>>> lambda_2: 8e-07
>>> init_weight: False
>>> save_laptop_acc: 0.82
>>> save_restaurant_acc: 0.874
>>> save_twitter_acc: 0.784
>>> save_restaurant15_acc: 0.856
>>> save_restaurant16_acc: 0.92
>>> restaurant_acc: 0.874
>>> laptop_acc: 0.82
>>> twitter_acc: 0.784
>>> restaurant15_acc: 0.856
>>> restaurant16_acc: 0.92
>>> model_class: <class 'models.ourmodel_z_d.OurModelBertClassifier'>
>>> dataset_file: {'train': './dataset_/Restaurants15_corenlp/train_write.json', 'test': './dataset_/Restaurants15_corenlp/test_write.json'}
>>> inputs_cols: ['adj_f', 'adj_b', 'adj_f_aspect', 'adj_b_aspect', 'text_bert_indices', 'bert_segments_ids', 'attention_mask', 'text_len', 'post_1', 'asp_start', 'asp_end', 'src_mask', 'aspect_mask', 'polarity']
bert learning rate on
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
[36m>> saved: ./state_dict/ourmodel_bert_restaurant15_acc_0.6015_f1_0.2604[39m
[33m  1.0   loss: 1.4046, acc: 0.8125, test_acc: 0.6015, f1: 0.2604[39m
[33m  2.0   loss: 1.3626, acc: 0.7500, test_acc: 0.6015, f1: 0.2604[39m
[33m  3.0   loss: 1.3212, acc: 0.7292, test_acc: 0.6015, f1: 0.2604[39m
[33m  4.0   loss: 1.2451, acc: 0.7188, test_acc: 0.6015, f1: 0.2604[39m
[33m  5.0   loss: 0.8970, acc: 0.7750, test_acc: 0.6015, f1: 0.2604[39m
[33m  6.0   loss: 1.3375, acc: 0.7396, test_acc: 0.6015, f1: 0.2604[39m
[33m  7.0   loss: 1.0448, acc: 0.7411, test_acc: 0.6015, f1: 0.2604[39m
[33m  8.0   loss: 1.0849, acc: 0.7344, test_acc: 0.6015, f1: 0.2604[39m
[33m  9.0   loss: 0.9473, acc: 0.7431, test_acc: 0.6015, f1: 0.2604[39m
[33m  10.0   loss: 0.8854, acc: 0.7500, test_acc: 0.6015, f1: 0.2604[39m
[36m>> saved: ./state_dict/ourmodel_bert_restaurant15_acc_0.6070_f1_0.2716[39m
[33m  11.0   loss: 0.9630, acc: 0.7443, test_acc: 0.6070, f1: 0.2716[39m
[36m>> saved: ./state_dict/ourmodel_bert_restaurant15_acc_0.6531_f1_0.3539[39m
[33m  12.0   loss: 0.8510, acc: 0.7500, test_acc: 0.6531, f1: 0.3539[39m
[36m>> saved: ./state_dict/ourmodel_bert_restaurant15_acc_0.7768_f1_0.5222[39m
[33m  13.0   loss: 0.7252, acc: 0.7644, test_acc: 0.7768, f1: 0.5222[39m
[33m  14.0   loss: 0.7840, acc: 0.7723, test_acc: 0.7675, f1: 0.5126[39m
[33m  15.0   loss: 0.6846, acc: 0.7833, test_acc: 0.6974, f1: 0.4241[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
[33m  16.0   loss: 0.7734, acc: 0.9375, test_acc: 0.7343, f1: 0.4754[39m
[36m>> saved: ./state_dict/ourmodel_bert_restaurant15_acc_0.7860_f1_0.5278[39m
[33m  17.0   loss: 0.6356, acc: 0.9375, test_acc: 0.7860, f1: 0.5278[39m
[33m  18.0   loss: 0.9108, acc: 0.8542, test_acc: 0.7749, f1: 0.5174[39m
[33m  19.0   loss: 0.6709, acc: 0.8594, test_acc: 0.7749, f1: 0.5172[39m
[33m  20.0   loss: 0.6751, acc: 0.8625, test_acc: 0.7841, f1: 0.5235[39m
[36m>> saved: ./state_dict/ourmodel_bert_restaurant15_acc_0.8063_f1_0.5447[39m
[33m  21.0   loss: 0.6866, acc: 0.8646, test_acc: 0.8063, f1: 0.5447[39m
[33m  22.0   loss: 0.6588, acc: 0.8661, test_acc: 0.8007, f1: 0.5442[39m
[33m  23.0   loss: 0.8428, acc: 0.8594, test_acc: 0.7934, f1: 0.5330[39m
[33m  24.0   loss: 0.4935, acc: 0.8681, test_acc: 0.7934, f1: 0.5313[39m
[33m  25.0   loss: 0.3965, acc: 0.8812, test_acc: 0.8044, f1: 0.5409[39m
[33m  26.0   loss: 0.8617, acc: 0.8807, test_acc: 0.7970, f1: 0.5347[39m
[36m>> saved: ./state_dict/ourmodel_bert_restaurant15_acc_0.8118_f1_0.5479[39m
[33m  27.0   loss: 0.6203, acc: 0.8854, test_acc: 0.8118, f1: 0.5479[39m
[33m  28.0   loss: 0.8998, acc: 0.8798, test_acc: 0.8007, f1: 0.5372[39m
[33m  29.0   loss: 0.5775, acc: 0.8839, test_acc: 0.7989, f1: 0.5367[39m
[33m  30.0   loss: 0.7037, acc: 0.8833, test_acc: 0.7989, f1: 0.5441[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
[33m  31.0   loss: 0.6377, acc: 0.8750, test_acc: 0.8007, f1: 0.5440[39m
[33m  32.0   loss: 0.5768, acc: 0.8750, test_acc: 0.7897, f1: 0.5259[39m
[33m  33.0   loss: 0.3517, acc: 0.9167, test_acc: 0.7952, f1: 0.5307[39m
[33m  34.0   loss: 0.5912, acc: 0.9062, test_acc: 0.7546, f1: 0.4899[39m
[33m  35.0   loss: 0.8495, acc: 0.8875, test_acc: 0.7565, f1: 0.4950[39m
[33m  36.0   loss: 0.7823, acc: 0.8750, test_acc: 0.7823, f1: 0.5233[39m
[33m  37.0   loss: 0.6051, acc: 0.8839, test_acc: 0.7731, f1: 0.5133[39m
[33m  38.0   loss: 0.6848, acc: 0.8750, test_acc: 0.7934, f1: 0.5341[39m
[33m  39.0   loss: 0.5657, acc: 0.8750, test_acc: 0.8026, f1: 0.5432[39m
[33m  40.0   loss: 0.4760, acc: 0.8812, test_acc: 0.7915, f1: 0.5349[39m
[33m  41.0   loss: 0.4006, acc: 0.8864, test_acc: 0.7934, f1: 0.5351[39m
[33m  42.0   loss: 0.7403, acc: 0.8750, test_acc: 0.7878, f1: 0.5268[39m
[33m  43.0   loss: 0.3884, acc: 0.8846, test_acc: 0.7362, f1: 0.4726[39m
[33m  44.0   loss: 0.3007, acc: 0.8929, test_acc: 0.7915, f1: 0.5338[39m
[33m  45.0   loss: 0.8044, acc: 0.8875, test_acc: 0.7565, f1: 0.5151[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
[33m  46.0   loss: 0.4543, acc: 0.9375, test_acc: 0.7731, f1: 0.5254[39m
[33m  47.0   loss: 0.4228, acc: 0.9375, test_acc: 0.7989, f1: 0.5365[39m
[33m  48.0   loss: 0.5426, acc: 0.9167, test_acc: 0.7343, f1: 0.4693[39m
[33m  49.0   loss: 0.6998, acc: 0.8906, test_acc: 0.7989, f1: 0.5358[39m
[33m  50.0   loss: 0.4578, acc: 0.9000, test_acc: 0.7970, f1: 0.5402[39m
[33m  51.0   loss: 0.8013, acc: 0.8854, test_acc: 0.8081, f1: 0.5472[39m
[33m  52.0   loss: 0.3967, acc: 0.8929, test_acc: 0.8063, f1: 0.5429[39m
[33m  53.0   loss: 0.2188, acc: 0.9062, test_acc: 0.8063, f1: 0.5421[39m
[33m  54.0   loss: 0.6647, acc: 0.8958, test_acc: 0.8063, f1: 0.5418[39m
[33m  55.0   loss: 0.2804, acc: 0.9062, test_acc: 0.8100, f1: 0.5436[39m
[33m  56.0   loss: 0.4801, acc: 0.9034, test_acc: 0.8081, f1: 0.5427[39m
[33m  57.0   loss: 0.4744, acc: 0.8958, test_acc: 0.8026, f1: 0.5441[39m
[33m  58.0   loss: 0.3422, acc: 0.8990, test_acc: 0.8063, f1: 0.5467[39m
[33m  59.0   loss: 0.2022, acc: 0.9062, test_acc: 0.8044, f1: 0.5419[39m
[33m  60.0   loss: 0.2997, acc: 0.9125, test_acc: 0.7878, f1: 0.5243[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
[33m  61.0   loss: 0.3702, acc: 0.9375, test_acc: 0.8063, f1: 0.5421[39m
[33m  62.0   loss: 0.1629, acc: 0.9688, test_acc: 0.8100, f1: 0.5476[39m
[36m>> saved: ./state_dict/ourmodel_bert_restaurant15_acc_0.8137_f1_0.5509[39m
[33m  63.0   loss: 0.5298, acc: 0.9167, test_acc: 0.8137, f1: 0.5509[39m
[33m  64.0   loss: 0.1940, acc: 0.9375, test_acc: 0.8137, f1: 0.5510[39m
[33m  65.0   loss: 0.2628, acc: 0.9500, test_acc: 0.8118, f1: 0.5491[39m
[33m  66.0   loss: 0.2378, acc: 0.9583, test_acc: 0.8118, f1: 0.5491[39m
[33m  67.0   loss: 0.3097, acc: 0.9554, test_acc: 0.7952, f1: 0.5296[39m
[33m  68.0   loss: 0.4423, acc: 0.9531, test_acc: 0.7749, f1: 0.5088[39m
[33m  69.0   loss: 0.6393, acc: 0.9444, test_acc: 0.7786, f1: 0.5132[39m
[36m>> saved: ./state_dict/ourmodel_bert_restaurant15_acc_0.8173_f1_0.5511[39m
[33m  70.0   loss: 0.2059, acc: 0.9500, test_acc: 0.8173, f1: 0.5511[39m
[33m  71.0   loss: 0.3689, acc: 0.9489, test_acc: 0.8007, f1: 0.5419[39m
[33m  72.0   loss: 0.5649, acc: 0.9427, test_acc: 0.8155, f1: 0.5514[39m
[33m  73.0   loss: 0.1637, acc: 0.9471, test_acc: 0.8155, f1: 0.5475[39m
[33m  74.0   loss: 0.6032, acc: 0.9420, test_acc: 0.7952, f1: 0.5275[39m
[33m  75.0   loss: 0.3189, acc: 0.9417, test_acc: 0.7897, f1: 0.5221[39m
[33m  76.0   loss: 0.1129, acc: 0.9426, test_acc: 0.7970, f1: 0.5310[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
[33m  77.0   loss: 0.3485, acc: 0.9375, test_acc: 0.7989, f1: 0.5331[39m
[33m  78.0   loss: 0.7138, acc: 0.9062, test_acc: 0.8118, f1: 0.5460[39m
[33m  79.0   loss: 0.3161, acc: 0.9167, test_acc: 0.8155, f1: 0.5519[39m
[33m  80.0   loss: 0.2890, acc: 0.9219, test_acc: 0.8155, f1: 0.5519[39m
[36m>> saved: ./state_dict/ourmodel_bert_restaurant15_acc_0.8229_f1_0.5540[39m
[33m  81.0   loss: 0.3506, acc: 0.9250, test_acc: 0.8229, f1: 0.5540[39m
[33m  82.0   loss: 0.3291, acc: 0.9271, test_acc: 0.8155, f1: 0.5472[39m
[33m  83.0   loss: 0.2053, acc: 0.9375, test_acc: 0.8229, f1: 0.5537[39m
[36m>> saved: ./state_dict/ourmodel_bert_restaurant15_acc_0.8247_f1_0.5571[39m
[33m  84.0   loss: 0.3243, acc: 0.9297, test_acc: 0.8247, f1: 0.5571[39m
[33m  85.0   loss: 0.2710, acc: 0.9306, test_acc: 0.8247, f1: 0.5568[39m
[33m  86.0   loss: 0.3404, acc: 0.9313, test_acc: 0.8229, f1: 0.5543[39m
[33m  87.0   loss: 0.2898, acc: 0.9318, test_acc: 0.8247, f1: 0.5559[39m
[33m  88.0   loss: 0.3436, acc: 0.9323, test_acc: 0.8229, f1: 0.5572[39m
[33m  89.0   loss: 0.2951, acc: 0.9327, test_acc: 0.8137, f1: 0.5520[39m
[33m  90.0   loss: 0.3699, acc: 0.9330, test_acc: 0.8155, f1: 0.5522[39m
[33m  91.0   loss: 0.1699, acc: 0.9375, test_acc: 0.7878, f1: 0.5258[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
[33m  92.0   loss: 0.1323, acc: 1.0000, test_acc: 0.7620, f1: 0.4981[39m
[33m  93.0   loss: 0.1249, acc: 1.0000, test_acc: 0.7546, f1: 0.4892[39m
[33m  94.0   loss: 0.3116, acc: 0.9792, test_acc: 0.7952, f1: 0.5301[39m
[33m  95.0   loss: 0.1128, acc: 0.9844, test_acc: 0.8155, f1: 0.5502[39m
[33m  96.0   loss: 0.3773, acc: 0.9750, test_acc: 0.7989, f1: 0.5342[39m
[33m  97.0   loss: 0.6741, acc: 0.9583, test_acc: 0.7952, f1: 0.5300[39m
[33m  98.0   loss: 0.8058, acc: 0.9286, test_acc: 0.8081, f1: 0.5418[39m
[36m>> saved: ./state_dict/ourmodel_bert_restaurant15_acc_0.8266_f1_0.5763[39m
[33m  99.0   loss: 0.1972, acc: 0.9375, test_acc: 0.8266, f1: 0.5763[39m
[33m  100.0   loss: 0.1801, acc: 0.9444, test_acc: 0.8118, f1: 0.5953[39m
[33m  101.0   loss: 0.2614, acc: 0.9500, test_acc: 0.7823, f1: 0.5521[39m
[33m  102.0   loss: 0.5226, acc: 0.9489, test_acc: 0.8118, f1: 0.5956[39m
[33m  103.0   loss: 0.1448, acc: 0.9531, test_acc: 0.8155, f1: 0.6533[39m
[36m>> saved: ./state_dict/ourmodel_bert_restaurant15_acc_0.8284_f1_0.6535[39m
[33m  104.0   loss: 0.0930, acc: 0.9567, test_acc: 0.8284, f1: 0.6535[39m
[33m  105.0   loss: 0.3765, acc: 0.9554, test_acc: 0.8247, f1: 0.6682[39m
[33m  106.0   loss: 0.1366, acc: 0.9583, test_acc: 0.8081, f1: 0.6222[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
[33m  107.0   loss: 0.3906, acc: 0.9375, test_acc: 0.8026, f1: 0.5729[39m
[33m  108.0   loss: 0.1714, acc: 0.9688, test_acc: 0.8063, f1: 0.5756[39m
[33m  109.0   loss: 0.1395, acc: 0.9792, test_acc: 0.8155, f1: 0.5996[39m
[33m  110.0   loss: 0.1235, acc: 0.9844, test_acc: 0.8266, f1: 0.6379[39m
[33m  111.0   loss: 0.1541, acc: 0.9750, test_acc: 0.8229, f1: 0.6554[39m
[33m  112.0   loss: 0.0684, acc: 0.9792, test_acc: 0.8266, f1: 0.6711[39m
[33m  113.0   loss: 0.1863, acc: 0.9821, test_acc: 0.8044, f1: 0.6154[39m
[33m  114.0   loss: 0.1050, acc: 0.9844, test_acc: 0.8118, f1: 0.6239[39m
[33m  115.0   loss: 0.1457, acc: 0.9861, test_acc: 0.8100, f1: 0.6222[39m
[33m  116.0   loss: 0.0962, acc: 0.9875, test_acc: 0.8155, f1: 0.6398[39m
[33m  117.0   loss: 0.2320, acc: 0.9830, test_acc: 0.8100, f1: 0.6332[39m
[33m  118.0   loss: 0.0822, acc: 0.9844, test_acc: 0.7731, f1: 0.6184[39m
[33m  119.0   loss: 0.1595, acc: 0.9856, test_acc: 0.7934, f1: 0.6653[39m
[33m  120.0   loss: 0.1565, acc: 0.9866, test_acc: 0.8284, f1: 0.6702[39m
[33m  121.0   loss: 0.2817, acc: 0.9833, test_acc: 0.8229, f1: 0.6544[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
[36m>> saved: ./state_dict/ourmodel_bert_restaurant15_acc_0.8321_f1_0.7200[39m
[33m  122.0   loss: 0.1603, acc: 1.0000, test_acc: 0.8321, f1: 0.7200[39m
[33m  123.0   loss: 0.1663, acc: 0.9688, test_acc: 0.7970, f1: 0.6738[39m
[33m  124.0   loss: 0.1888, acc: 0.9583, test_acc: 0.8266, f1: 0.7161[39m
[36m>> saved: ./state_dict/ourmodel_bert_restaurant15_acc_0.8339_f1_0.6882[39m
[33m  125.0   loss: 0.0792, acc: 0.9688, test_acc: 0.8339, f1: 0.6882[39m
[33m  126.0   loss: 0.4896, acc: 0.9625, test_acc: 0.8284, f1: 0.6706[39m
[33m  127.0   loss: 0.1418, acc: 0.9688, test_acc: 0.8303, f1: 0.6627[39m
[33m  128.0   loss: 0.0707, acc: 0.9732, test_acc: 0.8284, f1: 0.6631[39m
[33m  129.0   loss: 0.2491, acc: 0.9688, test_acc: 0.8284, f1: 0.6599[39m
[36m>> saved: ./state_dict/ourmodel_bert_restaurant15_acc_0.8432_f1_0.7357[39m
[33m  130.0   loss: 0.0715, acc: 0.9722, test_acc: 0.8432, f1: 0.7357[39m
[33m  131.0   loss: 0.1177, acc: 0.9750, test_acc: 0.8376, f1: 0.7267[39m
[33m  132.0   loss: 0.1317, acc: 0.9773, test_acc: 0.8321, f1: 0.7145[39m
[33m  133.0   loss: 0.1695, acc: 0.9792, test_acc: 0.8376, f1: 0.7192[39m
[33m  134.0   loss: 0.4341, acc: 0.9760, test_acc: 0.8339, f1: 0.6828[39m
[33m  135.0   loss: 0.1467, acc: 0.9777, test_acc: 0.8266, f1: 0.6572[39m
[33m  136.0   loss: 0.5959, acc: 0.9750, test_acc: 0.8247, f1: 0.6649[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
[33m  137.0   loss: 0.1117, acc: 1.0000, test_acc: 0.8266, f1: 0.6769[39m
[33m  138.0   loss: 0.1571, acc: 1.0000, test_acc: 0.8266, f1: 0.6769[39m
[33m  139.0   loss: 0.3395, acc: 0.9792, test_acc: 0.8266, f1: 0.6769[39m
[33m  140.0   loss: 0.1165, acc: 0.9844, test_acc: 0.8266, f1: 0.6769[39m
[33m  141.0   loss: 0.0734, acc: 0.9875, test_acc: 0.8247, f1: 0.6666[39m
[33m  142.0   loss: 0.1191, acc: 0.9896, test_acc: 0.8413, f1: 0.6722[39m
[33m  143.0   loss: 0.0845, acc: 0.9911, test_acc: 0.8395, f1: 0.6601[39m
[33m  144.0   loss: 0.1066, acc: 0.9922, test_acc: 0.8358, f1: 0.6463[39m
[33m  145.0   loss: 0.1921, acc: 0.9861, test_acc: 0.8395, f1: 0.6493[39m
[33m  146.0   loss: 0.5711, acc: 0.9812, test_acc: 0.8376, f1: 0.6781[39m
[33m  147.0   loss: 0.1503, acc: 0.9830, test_acc: 0.8432, f1: 0.7109[39m
[33m  148.0   loss: 0.2104, acc: 0.9844, test_acc: 0.8432, f1: 0.7114[39m
[33m  149.0   loss: 0.0728, acc: 0.9856, test_acc: 0.8413, f1: 0.7360[39m
[33m  150.0   loss: 0.1410, acc: 0.9866, test_acc: 0.8358, f1: 0.7296[39m
[33m  151.0   loss: 0.2362, acc: 0.9875, test_acc: 0.8395, f1: 0.6950[39m
[33m  152.0   loss: 0.0193, acc: 0.9877, test_acc: 0.7509, f1: 0.6035[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
[33m  153.0   loss: 0.1855, acc: 0.9375, test_acc: 0.8044, f1: 0.6503[39m
[33m  154.0   loss: 0.1037, acc: 0.9688, test_acc: 0.8339, f1: 0.6581[39m
[33m  155.0   loss: 0.1553, acc: 0.9792, test_acc: 0.8358, f1: 0.6986[39m
[33m  156.0   loss: 0.3984, acc: 0.9688, test_acc: 0.8210, f1: 0.6927[39m
[33m  157.0   loss: 0.1539, acc: 0.9750, test_acc: 0.8321, f1: 0.7372[39m
[33m  158.0   loss: 0.0938, acc: 0.9792, test_acc: 0.8339, f1: 0.7294[39m
[33m  159.0   loss: 0.0921, acc: 0.9821, test_acc: 0.8339, f1: 0.7158[39m
[33m  160.0   loss: 0.0756, acc: 0.9844, test_acc: 0.8210, f1: 0.6967[39m
[33m  161.0   loss: 0.1436, acc: 0.9861, test_acc: 0.8173, f1: 0.6465[39m
[33m  162.0   loss: 0.2307, acc: 0.9812, test_acc: 0.7970, f1: 0.6460[39m
[33m  163.0   loss: 0.0657, acc: 0.9830, test_acc: 0.7657, f1: 0.6019[39m
[33m  164.0   loss: 0.5038, acc: 0.9792, test_acc: 0.7860, f1: 0.6277[39m
[33m  165.0   loss: 0.0987, acc: 0.9808, test_acc: 0.8118, f1: 0.6669[39m
[33m  166.0   loss: 0.1025, acc: 0.9821, test_acc: 0.8284, f1: 0.6874[39m
[33m  167.0   loss: 0.1496, acc: 0.9833, test_acc: 0.8044, f1: 0.6654[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
[33m  168.0   loss: 0.1145, acc: 1.0000, test_acc: 0.8026, f1: 0.6851[39m
[33m  169.0   loss: 0.1229, acc: 1.0000, test_acc: 0.8100, f1: 0.7085[39m
[33m  170.0   loss: 0.1038, acc: 1.0000, test_acc: 0.8155, f1: 0.6909[39m
[33m  171.0   loss: 0.0870, acc: 1.0000, test_acc: 0.8339, f1: 0.7145[39m
[33m  172.0   loss: 0.0974, acc: 1.0000, test_acc: 0.8358, f1: 0.7176[39m
[33m  173.0   loss: 0.0508, acc: 1.0000, test_acc: 0.8339, f1: 0.7158[39m
[33m  174.0   loss: 0.0982, acc: 1.0000, test_acc: 0.8376, f1: 0.7321[39m
[36m>> saved: ./state_dict/ourmodel_bert_restaurant15_acc_0.8450_f1_0.7357[39m
[33m  175.0   loss: 0.0701, acc: 1.0000, test_acc: 0.8450, f1: 0.7357[39m
[33m  176.0   loss: 0.1198, acc: 1.0000, test_acc: 0.8432, f1: 0.7283[39m
[33m  177.0   loss: 0.2177, acc: 1.0000, test_acc: 0.8432, f1: 0.7260[39m
[33m  178.0   loss: 0.0674, acc: 1.0000, test_acc: 0.8395, f1: 0.7179[39m
[33m  179.0   loss: 0.0739, acc: 1.0000, test_acc: 0.8192, f1: 0.6815[39m
[33m  180.0   loss: 0.0627, acc: 1.0000, test_acc: 0.8192, f1: 0.6700[39m
[33m  181.0   loss: 0.1182, acc: 1.0000, test_acc: 0.8247, f1: 0.6630[39m
[33m  182.0   loss: 0.0539, acc: 1.0000, test_acc: 0.7860, f1: 0.6146[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
[33m  183.0   loss: 0.0680, acc: 1.0000, test_acc: 0.7694, f1: 0.5953[39m
[33m  184.0   loss: 0.0801, acc: 1.0000, test_acc: 0.7675, f1: 0.6057[39m
[33m  185.0   loss: 0.0864, acc: 1.0000, test_acc: 0.7786, f1: 0.6267[39m
[33m  186.0   loss: 0.6888, acc: 0.9688, test_acc: 0.8007, f1: 0.6399[39m
[33m  187.0   loss: 0.5841, acc: 0.9625, test_acc: 0.8339, f1: 0.6594[39m
[33m  188.0   loss: 0.2942, acc: 0.9583, test_acc: 0.8192, f1: 0.6084[39m
[33m  189.0   loss: 0.1434, acc: 0.9643, test_acc: 0.8081, f1: 0.6011[39m
[33m  190.0   loss: 0.4632, acc: 0.9531, test_acc: 0.8247, f1: 0.6113[39m
[33m  191.0   loss: 0.0791, acc: 0.9583, test_acc: 0.8044, f1: 0.6437[39m
[33m  192.0   loss: 0.1452, acc: 0.9563, test_acc: 0.7731, f1: 0.6218[39m
[33m  193.0   loss: 0.3115, acc: 0.9545, test_acc: 0.7565, f1: 0.5993[39m
[33m  194.0   loss: 0.3603, acc: 0.9531, test_acc: 0.7528, f1: 0.5969[39m
[33m  195.0   loss: 0.1647, acc: 0.9519, test_acc: 0.7583, f1: 0.6229[39m
[33m  196.0   loss: 0.3249, acc: 0.9509, test_acc: 0.7823, f1: 0.6526[39m
[33m  197.0   loss: 0.1002, acc: 0.9542, test_acc: 0.8118, f1: 0.6705[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
[33m  198.0   loss: 0.4671, acc: 0.9375, test_acc: 0.8100, f1: 0.6475[39m
[33m  199.0   loss: 0.0757, acc: 0.9688, test_acc: 0.8210, f1: 0.6560[39m
[33m  200.0   loss: 0.0915, acc: 0.9792, test_acc: 0.8229, f1: 0.6689[39m
[33m  201.0   loss: 0.0553, acc: 0.9844, test_acc: 0.8173, f1: 0.6638[39m
[33m  202.0   loss: 0.0707, acc: 0.9875, test_acc: 0.8155, f1: 0.6934[39m
[33m  203.0   loss: 0.0931, acc: 0.9896, test_acc: 0.8137, f1: 0.7035[39m
[33m  204.0   loss: 0.5673, acc: 0.9821, test_acc: 0.8137, f1: 0.7050[39m
[33m  205.0   loss: 0.1970, acc: 0.9766, test_acc: 0.8063, f1: 0.6890[39m
[33m  206.0   loss: 0.1209, acc: 0.9792, test_acc: 0.8081, f1: 0.6979[39m
[33m  207.0   loss: 0.0766, acc: 0.9812, test_acc: 0.8137, f1: 0.7010[39m
[33m  208.0   loss: 0.0895, acc: 0.9830, test_acc: 0.8118, f1: 0.6975[39m
[33m  209.0   loss: 0.1777, acc: 0.9792, test_acc: 0.8210, f1: 0.7083[39m
[33m  210.0   loss: 0.0588, acc: 0.9808, test_acc: 0.8229, f1: 0.7146[39m
[33m  211.0   loss: 0.1175, acc: 0.9821, test_acc: 0.8155, f1: 0.6811[39m
[33m  212.0   loss: 0.0794, acc: 0.9833, test_acc: 0.8155, f1: 0.6708[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 15
[33m  213.0   loss: 0.1516, acc: 0.9375, test_acc: 0.8192, f1: 0.6740[39m
[33m  214.0   loss: 0.0755, acc: 0.9688, test_acc: 0.8173, f1: 0.6724[39m
[33m  215.0   loss: 0.0766, acc: 0.9792, test_acc: 0.8173, f1: 0.6724[39m
[33m  216.0   loss: 0.1158, acc: 0.9844, test_acc: 0.8210, f1: 0.6753[39m
[33m  217.0   loss: 0.0710, acc: 0.9875, test_acc: 0.8210, f1: 0.6854[39m
[33m  218.0   loss: 0.1339, acc: 0.9896, test_acc: 0.8229, f1: 0.6870[39m
[33m  219.0   loss: 0.0589, acc: 0.9911, test_acc: 0.8266, f1: 0.6998[39m
[33m  220.0   loss: 0.0957, acc: 0.9922, test_acc: 0.8266, f1: 0.6998[39m
[33m  221.0   loss: 0.0961, acc: 0.9931, test_acc: 0.8266, f1: 0.6998[39m
[33m  222.0   loss: 0.5583, acc: 0.9875, test_acc: 0.8229, f1: 0.6962[39m
[33m  223.0   loss: 0.1216, acc: 0.9886, test_acc: 0.8173, f1: 0.7097[39m
[33m  224.0   loss: 0.1022, acc: 0.9896, test_acc: 0.8026, f1: 0.6738[39m
[33m  225.0   loss: 0.1352, acc: 0.9904, test_acc: 0.8081, f1: 0.6827[39m
[33m  226.0   loss: 0.0680, acc: 0.9911, test_acc: 0.8100, f1: 0.6889[39m
[33m  227.0   loss: 0.0903, acc: 0.9917, test_acc: 0.8100, f1: 0.6713[39m
[33m  228.0   loss: 0.0161, acc: 0.9918, test_acc: 0.8137, f1: 0.6718[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 16
[33m  229.0   loss: 0.0460, acc: 1.0000, test_acc: 0.8137, f1: 0.6722[39m
[33m  230.0   loss: 0.0815, acc: 1.0000, test_acc: 0.8081, f1: 0.6660[39m
[33m  231.0   loss: 0.1148, acc: 1.0000, test_acc: 0.8155, f1: 0.6725[39m
[33m  232.0   loss: 0.0706, acc: 1.0000, test_acc: 0.8321, f1: 0.7055[39m
[33m  233.0   loss: 0.2146, acc: 0.9875, test_acc: 0.8229, f1: 0.7174[39m
[33m  234.0   loss: 0.0653, acc: 0.9896, test_acc: 0.8100, f1: 0.7069[39m
[33m  235.0   loss: 0.0592, acc: 0.9911, test_acc: 0.7804, f1: 0.6462[39m
[33m  236.0   loss: 0.1237, acc: 0.9922, test_acc: 0.7675, f1: 0.6294[39m
[33m  237.0   loss: 0.1059, acc: 0.9931, test_acc: 0.8063, f1: 0.6799[39m
[33m  238.0   loss: 0.0589, acc: 0.9938, test_acc: 0.8247, f1: 0.7200[39m
[33m  239.0   loss: 0.0980, acc: 0.9943, test_acc: 0.8358, f1: 0.7325[39m
[33m  240.0   loss: 0.0778, acc: 0.9948, test_acc: 0.8358, f1: 0.7353[39m
[33m  241.0   loss: 0.0605, acc: 0.9952, test_acc: 0.8376, f1: 0.7315[39m
[33m  242.0   loss: 0.2797, acc: 0.9911, test_acc: 0.8358, f1: 0.7231[39m
[33m  243.0   loss: 0.3709, acc: 0.9875, test_acc: 0.8210, f1: 0.6867[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 17
[33m  244.0   loss: 0.0128, acc: 1.0000, test_acc: 0.8063, f1: 0.6594[39m
[33m  245.0   loss: 0.0831, acc: 1.0000, test_acc: 0.8007, f1: 0.6501[39m
[33m  246.0   loss: 0.1062, acc: 1.0000, test_acc: 0.8007, f1: 0.6574[39m
[33m  247.0   loss: 0.0883, acc: 1.0000, test_acc: 0.8210, f1: 0.6929[39m
[33m  248.0   loss: 0.1546, acc: 1.0000, test_acc: 0.8192, f1: 0.6845[39m
[33m  249.0   loss: 0.1571, acc: 1.0000, test_acc: 0.8192, f1: 0.6886[39m
[33m  250.0   loss: 0.1065, acc: 1.0000, test_acc: 0.8229, f1: 0.6945[39m
[33m  251.0   loss: 0.0569, acc: 1.0000, test_acc: 0.8229, f1: 0.6971[39m
[33m  252.0   loss: 0.1643, acc: 0.9931, test_acc: 0.8229, f1: 0.6999[39m
[33m  253.0   loss: 0.1242, acc: 0.9875, test_acc: 0.8192, f1: 0.6809[39m
[33m  254.0   loss: 0.1079, acc: 0.9886, test_acc: 0.8247, f1: 0.6900[39m
[33m  255.0   loss: 0.0626, acc: 0.9896, test_acc: 0.8247, f1: 0.6984[39m
[33m  256.0   loss: 0.0530, acc: 0.9904, test_acc: 0.8155, f1: 0.6829[39m
[33m  257.0   loss: 0.0790, acc: 0.9911, test_acc: 0.8137, f1: 0.6812[39m
[33m  258.0   loss: 0.1023, acc: 0.9917, test_acc: 0.8210, f1: 0.7015[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 18
[33m  259.0   loss: 0.1229, acc: 0.9375, test_acc: 0.8247, f1: 0.6963[39m
[33m  260.0   loss: 0.0731, acc: 0.9688, test_acc: 0.8173, f1: 0.6926[39m
[33m  261.0   loss: 0.1765, acc: 0.9792, test_acc: 0.8247, f1: 0.7049[39m
[33m  262.0   loss: 0.1211, acc: 0.9844, test_acc: 0.8063, f1: 0.6783[39m
[33m  263.0   loss: 0.1629, acc: 0.9875, test_acc: 0.8229, f1: 0.7005[39m
[33m  264.0   loss: 0.0866, acc: 0.9896, test_acc: 0.8395, f1: 0.7235[39m
[33m  265.0   loss: 0.0422, acc: 0.9911, test_acc: 0.8450, f1: 0.7347[39m
[33m  266.0   loss: 0.1130, acc: 0.9922, test_acc: 0.8432, f1: 0.7271[39m
[33m  267.0   loss: 0.5449, acc: 0.9792, test_acc: 0.8413, f1: 0.7167[39m
[36m>> saved: ./state_dict/ourmodel_bert_restaurant15_acc_0.8561_f1_0.7391[39m
[33m  268.0   loss: 0.0626, acc: 0.9812, test_acc: 0.8561, f1: 0.7391[39m
[33m  269.0   loss: 0.0866, acc: 0.9830, test_acc: 0.8376, f1: 0.7112[39m
[33m  270.0   loss: 0.0667, acc: 0.9844, test_acc: 0.8413, f1: 0.7046[39m
[33m  271.0   loss: 0.1030, acc: 0.9808, test_acc: 0.8192, f1: 0.6989[39m
[33m  272.0   loss: 0.1660, acc: 0.9821, test_acc: 0.8081, f1: 0.6802[39m
[33m  273.0   loss: 0.0503, acc: 0.9833, test_acc: 0.7989, f1: 0.6434[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 19
[33m  274.0   loss: 0.1465, acc: 0.9375, test_acc: 0.8007, f1: 0.6457[39m
[33m  275.0   loss: 0.0351, acc: 0.9688, test_acc: 0.8229, f1: 0.6665[39m
[33m  276.0   loss: 0.0932, acc: 0.9792, test_acc: 0.8321, f1: 0.7152[39m
[33m  277.0   loss: 0.0698, acc: 0.9844, test_acc: 0.8266, f1: 0.7052[39m
[33m  278.0   loss: 0.1468, acc: 0.9875, test_acc: 0.8081, f1: 0.6821[39m
[33m  279.0   loss: 0.2392, acc: 0.9792, test_acc: 0.7989, f1: 0.6759[39m
[33m  280.0   loss: 0.1002, acc: 0.9821, test_acc: 0.8137, f1: 0.6882[39m
[33m  281.0   loss: 0.0877, acc: 0.9844, test_acc: 0.8118, f1: 0.6827[39m
[33m  282.0   loss: 0.0767, acc: 0.9861, test_acc: 0.8118, f1: 0.6857[39m
[33m  283.0   loss: 0.1226, acc: 0.9875, test_acc: 0.8118, f1: 0.6880[39m
[33m  284.0   loss: 0.1500, acc: 0.9886, test_acc: 0.8100, f1: 0.6860[39m
[33m  285.0   loss: 0.1225, acc: 0.9896, test_acc: 0.8303, f1: 0.7141[39m
[33m  286.0   loss: 0.0963, acc: 0.9904, test_acc: 0.8358, f1: 0.7110[39m
[33m  287.0   loss: 0.0826, acc: 0.9911, test_acc: 0.8395, f1: 0.7132[39m
[33m  288.0   loss: 0.0777, acc: 0.9917, test_acc: 0.8303, f1: 0.7088[39m
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 20
[33m  289.0   loss: 0.1758, acc: 0.9375, test_acc: 0.8155, f1: 0.6884[39m
[33m  290.0   loss: 0.0278, acc: 0.9688, test_acc: 0.8247, f1: 0.7018[39m
[33m  291.0   loss: 0.0931, acc: 0.9792, test_acc: 0.8247, f1: 0.6809[39m
[33m  292.0   loss: 0.0640, acc: 0.9844, test_acc: 0.8247, f1: 0.6816[39m
[33m  293.0   loss: 0.0121, acc: 0.9875, test_acc: 0.8266, f1: 0.7007[39m
[33m  294.0   loss: 0.1279, acc: 0.9792, test_acc: 0.8229, f1: 0.6939[39m
[33m  295.0   loss: 0.0541, acc: 0.9821, test_acc: 0.8192, f1: 0.6944[39m
[33m  296.0   loss: 0.0597, acc: 0.9844, test_acc: 0.8210, f1: 0.6965[39m
[33m  297.0   loss: 0.1124, acc: 0.9861, test_acc: 0.8247, f1: 0.7037[39m
[33m  298.0   loss: 0.1161, acc: 0.9875, test_acc: 0.8266, f1: 0.7121[39m
[33m  299.0   loss: 0.1576, acc: 0.9886, test_acc: 0.8284, f1: 0.7091[39m
[33m  300.0   loss: 0.0663, acc: 0.9896, test_acc: 0.8376, f1: 0.7136[39m
[33m  301.0   loss: 0.0887, acc: 0.9904, test_acc: 0.8339, f1: 0.7068[39m
[33m  302.0   loss: 0.0821, acc: 0.9911, test_acc: 0.8376, f1: 0.7032[39m
[33m  303.0   loss: 0.0679, acc: 0.9917, test_acc: 0.8358, f1: 0.7016[39m
[33m  304.0   loss: 0.0444, acc: 0.9918, test_acc: 0.8395, f1: 0.7068[39m
max_test_acc: 0.8560885608856088, max_f1: 0.7390519944078108
>> saved: ./state_dict/ourmodel_bert_restaurant15_acc_0.8561_f1_0.7391
############################################################
[34mmax_test_acc_overall:0.8560885608856088[39m
[34mmax_f1_overall:0.7390519944078108[39m
Precision, Recall and F1-Score...
              precision    recall  f1-score   support

           0     0.9105    0.9049    0.9077       326
           1     0.7839    0.8571    0.8189       182
           2     0.6842    0.3824    0.4906        34

    accuracy                         0.8561       542
   macro avg     0.7929    0.7148    0.7391       542
weighted avg     0.8538    0.8561    0.8517       542

Confusion Matrix...
[[295  30   1]
 [ 21 156   5]
 [  8  13  13]]
NumExpr defaulting to 8 threads.
stop run time:Sat Dec  2 14:00:57 2023
run time (hour:minute:second): 0:55:09.840518
